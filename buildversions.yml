# File: Common buildfile version stamping

parameters:
  fileversion: ''
  packageversion: ''

steps:
#- script: echo ${{ parameters.fileversion }} - ${{ parameters.packageversion }} 
- task: VersionDotNetCoreAssemblies@2
  displayName: 'Set FileVersion on *.csproj (netcore)'
  inputs: 
    # Required arguments
    Path: $(Build.SourcesDirectory)
    VersionNumber: ${{ parameters.fileversion }}
    VersionRegex: \d+\.\d+\.\d+\.\d+
    FilenamePattern: .csproj
    Field: FileVersion
    OutputVersion: OutputedVersion

# Version 'classic' .NET Assemblies
# Description - Applies a version to a .NET assembly via the assemblyinfo.cs or .vb files based on the build number.
# For the Plugin project(s) which are ClickOnce
- task: VersionAssemblies@2
  displayName: 'Set AssemblyFileVersion in AssemblyInfo.cs'
  inputs: 
    Path: $(Build.SourcesDirectory)
    VersionNumber: ${{ parameters.fileversion }}
    VersionRegex: \d+\.\d+\.\d+\.\d+
    FilenamePattern: SharedFileVersionInfo.cs
    Field: AssemblyFileVersion
    OutputVersion: OutputedVersion
